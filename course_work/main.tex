\documentclass[a4paper,14pt]{extarticle}
\usepackage[T2A]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage[english,russian]{babel}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{listings}
\usepackage{hyperref}

\usepackage{algorithm}
\usepackage{algpseudocode}
\usepackage{booktabs}
\usepackage{float}
\usepackage{subcaption}

\usepackage{xcolor}

\usepackage{indentfirst}
\usepackage[left = 20mm, right = 10mm, top = 20mm, bottom = 20mm]{geometry}
\usepackage[indent=1.25cm]{parskip}
\renewcommand{\baselinestretch}{1.5}


\newtheorem{theorem}{Теорема}
\newtheorem{lemma}{Лемма}
\newtheorem{definition}{Определение}

\lstset{label=Листинг, tabsize = 2, basicstyle=\ttfamily, captionpos=b, escapeinside={№}{/№}}

\DeclareMathOperator*{\argmin}{arg\,min}

\author{Попов Илья}

\begin{document}

\begin{titlepage}
    \newpage
    \begin{center}
        Московский государственный университет имени M.В. Ломоносова
        Механико-математический факультет\\
        Кафедра вычислительной математики \\
    \end{center}

    \vspace{8em}

    \begin{center}
        \Large Курсовая работа \\
    \end{center}

    \vspace{2em}

    \begin{center}
        \textsc{\textbf{}}
    \end{center}

    \vspace{20em}

    \newbox{\lbox}
    \newlength{\maxl}
    \setlength{\maxl}{\wd\lbox}
    \hfill\parbox{13cm}{
        \hspace*{5cm}\hspace*{-5cm}Студент: \qquad\qquad\hbox to \maxl{Попов Илья Викторович\hfill}\\
        \hspace*{5cm}\hspace*{-5cm}Преподаватель: \hbox to \maxl{Валединский Владимир Дмитриевич}\\
        \\
        \hspace*{5cm}\hspace*{-5cm}Группа:\qquad\qquad $\;\:$ \hbox to\maxl{310}\\
    }

    \vspace{\fill}

    \begin{center}
        Москва \\2025
    \end{center}

\end{titlepage}
\newpage


\title{Сравнение многогранников: оценка качества алгоритма построения объёмной модели трехмерного тела}
\date{\today}


\maketitle

\begin{abstract}
Работа включает в себя методы сравнения трёхмерных многогранников для оценки качества алгоритма построения трехмерной модели.
Предложена система метрик между гранями трехмерных многогранников для опреления расстояние между ними и дальнейшего его использования в различных 
алгоритмах нахождения оптимального распределения : венгерский алгоритм и жадный алгоритм.
\end{abstract}

\section{Введение}

\subsection{Постановка проблемы}
Алгоритму необходимо получить число, корое характеризовало бы схожесть двух многогранников в некорором смысле.

\section{Математическая модель}
\subsection{Формальное описание многогранника}
Многогранник $P$ может быть задан в виде троки:
\begin{equation}
P = (V, E, F), \text{ где}
\end{equation}
\begin{itemize}
    \item $V = \{\mathbf{v}_i\} \subset \mathbb{R}^3$ — множество вершин
    \item $E = \{e_{ij}\}$ — множество рёбер
    \item $F = \{f_k\}$ — множество граней
\end{itemize}

Для каждой грани $f_k$ многогранника определим eё основные характеристик:
\begin{itemize}
    \item Центр масс: $\mathbf{c}_k = \frac{1}{S_k} \sum\limits_{T \in \mathcal{T}_k} S_T \cdot \mathbf{c}_T$
    \noindent где:
    \begin{itemize}
        \item $\mathcal{T}_k$ -- множество треугольников триангуляции грани $f_k$ с помощью диагоналей
        \item $T$ -- отдельный треугольник в триангуляции (элемент $\mathcal{T}_k$)
        \item $S_T = \frac{1}{2}\|(\mathbf{v}_2 - \mathbf{v}_1) \times (\mathbf{v}_3 - \mathbf{v}_1)\|$ -- площадь треугольника $T$ 
            с вершинами $\mathbf{v}_1, \mathbf{v}_2, \mathbf{v}_3$
        \item $\mathbf{c}_T = \frac{1}{3}(\mathbf{v}_1 + \mathbf{v}_2 + \mathbf{v}_3)$ -- центр масс треугольника $T$
        \item $S_k = \sum_{T \in \mathcal{T}_k} S_T$ -- общая площадь грани $f_k$
    \end{itemize}
    \item Нормаль: $\mathbf{n}_k$ -- нормаль к плоскости, наилучшим образом приближающеё точки в смысле минимума суммы квадратов отклонений
\end{itemize}

\section{Метрики сравнения граней}
\begin{enumerate}
    \item Евклидово расстояние между центрами и евклидовов расстояние между нормалями:
        \begin{equation}
            d(f,g) = \alpha \cdot \sqrt{\|\mathbf{c}_f - \mathbf{c}_g\|_2} + \sqrt{\beta \cdot \|\mathbf{n}_f - \mathbf{n}_g\|_2} 
        \end{equation}
        \noindent где:
        \begin{itemize}
            \item $\alpha, \beta$ - весовые коэффициенты
            \item $\alpha, \beta \in \mathbb{R}_{>0}$ - множество положительных действительных чисел
            \item $\|\mathbf{c}_f - \mathbf{c}_g\|_2$ - евклидово расстояние между центрами
            \item $\|\mathbf{n}_f - \mathbf{n}_g\|_2$ - евклидово расстояние между нормалями
        \end{itemize}

    \item Метрика на основе симметрической разности проекций
        Для граней $f$ и $g$ определим метрику сравнения плоскостности:
        \begin{equation}
            d(f,g) = \frac{S(A \triangle B)}{S(A) + S(B)}
        \end{equation}
        где:
        \begin{itemize}
            \item $H_{avg}$ -- усредненная плоскость между гранями

            \item $A = \text{proj}_{H_{avg}}(f)$ -- проекция грани $f$ на $H_{avg}$

            \item $B = \text{proj}_{H_{avg}}(g)$ -- проекция грани $g$ на $H_{avg}$

            \item $A \triangle B = (A \cup B) \setminus (A \cap B)$ -- симметрическая разность проекций

            \item $S(\cdot)$ -- площадь соответствующей проекции
        \end{itemize}

        Заметим некоторые очевидые свойства этой метрикик:
        \begin{itemize}
            \item $d_{sd} \in [0,1]$ (нормирована)
            \item $d_{sd} = 0$ при полном совпадении проекций
            \item $d_{sd} = 1$ при нулевом пересечении проекций
        \end{itemize}


    \item Метрика сравнения граней на основе хаусдорфова расстояния:
        Для двух компактных множеств $A,B \subset \mathbb{R}^2$ хаусдорфово расстояние определяется как:
        $d_H(A,B) = \max\left\{\sup_{a \in A} \inf_{b \in B} \|a - b\|, \sup_{b \in B} \inf_{a \in A} \|a - b\|\right\}$

        \begin{equation}
            d(f,g) = d_H(\text{proj}_{H_{avg}}(f), \text{proj}_{H_{avg}}(g))
        \end{equation}

\end{enumerate}

\section{Алгоритмы сопоставления}

\subsection{Жадный алгоритм}
Пусть заданы:
\begin{itemize}
    \item Многогранник $M_{\text{ref}}$ с гранями $\{f_i\}_{i=1}^n$
    \item Многогранник $M_{\text{rec}}$ с гранями $\{g_j\}_{j=1}^m$
    \item Метрика $d(f_i, g_j) \geq 0$ (соответствий тем лучше, чем меньше расстояние)
\end{itemize}

\subsubsection{Алгоритм}
\begin{enumerate}
    \item Инициализировать пустое множество соответствий $\phi = \emptyset$
    \item Пока есть не сопоставленные грани:
    \begin{enumerate}
        \item Для всех пар $(f_i, g_j)$ найти минимальное значение метрики:
            \[ (f^*, g^*) = \argmin_{f_i \in F_{\text{несоп.}}, g_j \in G_{\text{несоп.}}} d(f_i, g_j) \]
        \item Добавить соответствие в множество: $\phi \leftarrow \phi \cup \{f^* \leftrightarrow g^*\}$
        \item Удалить $f^*$ из $F_{\text{несоп.}}$, $g^*$ из $G_{\text{несоп.}}$
    \end{enumerate}
    \item Вернуть $\phi$
\end{enumerate}

Особенности алгоритам:
\begin{itemize}
    \item Сложность:\newline
        Пусть $m >= n$, тогда \newline
        $\sum\limits_{i = 0}^{m - 1}(m - i) \cdot (n - i) = \sum\limits_{i = 0}^{m - 1}(m \cdot n - i \cdot m 
        - i \cdot n + i^2) = O(m^2 \cdot n + \frac{1}{6} \cdot m^3)$
    \item Не гарантирует глобално оптимальное соответствие
\end{itemize}


\subsection{Венгерский алгоритм}

\begin{definition}[Потенциал]
Два массива $u[1 \ldots n]$ и $v[1 \ldots n]$ называются \textbf{потенциалом}, если:
\begin{equation*}
u[i] + v[j] \leq a[i][j] \quad \forall i,j = 1,\ldots,n
\end{equation*}
Значение потенциала: $f = \sum u[i] + \sum v[j]$. Для любого решения $sol$ верно $sol \geq f$.
\end{definition}

\subsubsection*{Основная идея}
Алгоритм поддерживает:
\begin{itemize}
\item Потенциалы $u$, $v$ и паросочетание $M$ в графе жёстких рёбер $H = \{(i,j) | u[i]+v[j] = a[i][j]\}$
\item Если $|M| = n$, то $M$ — оптимальное решение
\item Иначе пересчёт потенциалов для расширения $H$
\end{itemize}

\subsubsection*{Шаги алгоритма}
\begin{enumerate}
\item \textbf{Инициализация}: 
\begin{align*}
u[i] &= 0, \quad v[j] = 0 \quad \forall i,j \\
M &= \emptyset 
\end{align*}

\item \textbf{Поиск увеличивающего пути}:
\begin{itemize}
\item Построить ориентированный граф: рёбра $M$ направлены справа налево, остальные — слева направо
\item Искать путь из ненасыщенных вершин слева в ненасыщенные справа
\item При успехе — увеличить $M$ вдоль пути
\end{itemize}

\item \textbf{Пересчёт потенциалов} (если путь не найден):
\begin{itemize}
\item $Z_1$ — достижимые вершины слева, $Z_2$ — справа
\item Вычислить 
\[
\Delta = \min_{\substack{i \in Z_1 \\ j \notin Z_2}} (a[i][j] - u[i] - v[j])
\]
\item Обновить:
\begin{align*}
u[i] &+= \Delta \quad \forall i \in Z_1 \\
v[j] &-= \Delta \quad \forall j \in Z_2
\end{align*}
\end{itemize}
\end{enumerate}

\subsubsection*{Свойства пересчёта}
\begin{itemize}
\item Сохраняются все жёсткие рёбра текущего паросочетания
\item Появляется новое жёсткое ребро между $Z_1$ и $V_2 \setminus Z_2$
\item Размер достижимого множества $(Z_1 \cup Z_2)$ строго растёт
\end{itemize}

\subsubsection*{Корректность}
\begin{itemize}
\item После $O(n)$ пересчётов мощность $M$ увеличивается
\item Всего требуется $n$ увеличений
\item Сложность: $O(n^4)$, но оптимизируется до $O(n^3)$
\end{itemize}

\begin{proof}[Ключевые моменты]
\begin{itemize}
\item Инвариант: $sol \geq f$ сохраняется всегда
\item Пересчёт потенциалов гарантирует прогресс
\item Максимальное паросочетание в $H$ соответствует оптимальному решению
\end{itemize}
\end{proof}



\begin{thebibliography}{9}
\bibitem{hungarian} 
Kuhn H.W. 
\textit{The Hungarian Method for the assignment problem}. 
Naval Research Logistics, 1955.

\bibitem{3dmetrics} 
Tangelder J.W., Veltkamp R.C. 
\textit{A survey of content based 3D shape retrieval methods}. 
Multimedia Tools and Applications, 2008.
\end{thebibliography}

\end{document}

